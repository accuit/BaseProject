ALTER TABLE `UserMaster` ADD `Created_Date` DATETIME NOT NULL AFTER `UserNote`, ADD `Created_By` INT(9) NOT NULL AFTER `Created_Date`, ADD `Modified_Date` DATETIME NULL AFTER `Created_By`;

CREATE TABLE ContactUsQuery_Master(
   PK_ID INT NOT NULL AUTO_INCREMENT,
   EnquiryFromEmail VARCHAR(200) NOT NULL,
   EnquiryFromName VARCHAR(100) NOT NULL,
   EnquirySubject VARCHAR(100) NOT NULL,
   EnquiryLocation VARCHAR(100) NOT NULL,
   EnquiryCompany VARCHAR(100) NOT NULL,
   EnquiryMessage VARCHAR(1000) NOT NULL,
   EnquiryPhone VARCHAR(100) NOT NULL,
   EnquiryFromIP VARCHAR(100) NULL,
   Created_Date Date NOT NULL,
   PRIMARY KEY ( PK_ID )
);
ALTER TABLE LoginAttemptHistory
DROP FK__LoginAtte__EmpID__59904A2C


CREATE TABLE ContactUsQuery_Content(
   PK_ID INT NOT NULL AUTO_INCREMENT,
   ResponseContent VARCHAR(1000) NOT NULL,
   ResponseFrom VARCHAR(100) NULL,
   Response_Date DateTime,
   Enquiry_Status VARCHAR(50) NULL,
   SpecialNote VARCHAR(500) NULL,
   ContactUsMaster_ID INT NULL,
   PRIMARY KEY ( PK_ID ),
   CONSTRAINT FK_ContactQryMaster_PKID FOREIGN KEY (ContactUsMaster_ID)
   REFERENCES ContactUsQuery_Master(PK_ID)
);

CREATE TABLE `EmbrofDB`.`ErrorLog`(
  `LogID` INT(9) NOT NULL,
  `EventID` INT(9) NOT NULL,
  `Priority` INT(3) NULL,
  `Severity` VARCHAR(50) NULL,
  `Title` VARCHAR(100) NULL,
  `TimeStamp` DATETIME NOT NULL,
  `MachineName` VARCHAR(100) NOT NULL,
  `AppDomainName` VARCHAR(100) NOT NULL,
  `ProcessID` VARCHAR(50) NOT NULL,
  `ProcessName` VARCHAR(50) NOT NULL,
  `ThreadName` VARCHAR(100) NOT NULL,
  `Win32ThreadId` VARCHAR(50) NOT NULL,
  `Message` VARCHAR(1000) NOT NULL,
  `FormattedMessage` VARCHAR(1000) NOT NULL,
  PRIMARY KEY(`LogID`)
) ENGINE = MyISAM;


CREATE TABLE `EmbrofDB`.`UserMaster`(
  `UserID` INT(9) NOT NULL,
  `LoginID` VARCHAR(150) NOT NULL,
  `LoginPassword` VARCHAR(50) NOT NULL,
  `FirstName` VARCHAR(50) NOT NULL,
  `MiddleName` VARCHAR(50) NULL,
  `LastName` VARCHAR(50) NULL,
  `Title` INT(2) NULL,
  `Gender` INT(1) NULL,
  `Email` VARCHAR(150) NOT NULL,
  `AltEmail` VARCHAR(150) NULL,
  `Phone` VARCHAR(30) NULL,
  `AltPhone` VARCHAR(30) NULL,
  `UserNote` VARCHAR(500) NULL,
  PRIMARY KEY(`UserID`)
) ENGINE = MyISAM

CREATE TABLE `EmbrofDB`.`AddressMaster`(
  `AddressID` INT(9) NOT NULL,
  `AddressType` INT(2) NOT NULL,
  `Address1` VARCHAR(150) NOT NULL,
  `Address2` VARCHAR(150) NULL,
  `City` VARCHAR(100) NULL,
  `State` VARCHAR(100) NULL,
  `PinCode` VARCHAR(10) NULL,
  `Status` INT(1) NULL,
  `Created_Date` DATETIME NOT NULL,
  `Modified_Date` DATETIME NULL,
  `Is_Deleted` INT(1) NULL,
  PRIMARY KEY(`AddressID`)
) ENGINE = MyISAM

CREATE TABLE `EmbrofDB`.`UserLoginHistory`(
  `LoginHistID` INT(9) NOT NULL,
  `UserID` INT(2) NOT NULL,
  `LoginTime` DATETIME NOT NULL,
  `SessionID` VARCHAR(500) NULL,
  `IPAddress` VARCHAR(30) NULL,
  `BrowserName` VARCHAR(30) NULL,
  `IsLogin` INT(1) NOT NULL,
  `LoginType` INT(1) NOT NULL,
  `LogoutTime` DATETIME NOT NULL,
  `Modified_Date` DATETIME NULL,
  `Is_Deleted` INT(1) NULL,
  PRIMARY KEY(`LoginHistID`)
) ENGINE = MyISAM

CREATE TABLE ProductMaster(
  Product_ID INT(9) NOT NULL AUTO_INCREMENT,
  Product_Name VARCHAR(100) NOT NULL,
  Product_Description VARCHAR(200) NULL,
  SKUCode VARCHAR(10) NULL,
  Product_Brand VARCHAR(100) NULL,
  Product_Color VARCHAR(30) NULL,
  Product_Size VARCHAR(100) NULL,
  Product_Type INT(2) NULL,
  Product_UserType INT(1) NOT NULL,
  Product_UnitPrice INT(9) NOT NULL,
  Category_ID INT(9) NULL,
  `Created_Date` DATETIME NOT NULL,
  `Created_By` INT(9) NULL,
  `Modified_Date` DATETIME NULL,
  `Modified_By` INT(9),
  `Is_Deleted` INT(1) NULL,
  PRIMARY KEY(Product_ID),
  CONSTRAINT FK_Product_CategoryID FOREIGN KEY(Category_ID) REFERENCES CategoryMaster(CategoryID)
);
http://localhost/Account/ChangePassword?id=02a7ffac-ad49-4c2b-9f65-8b49454837c0

CREATE TABLE dbo.ProductImage(
  ImageID BIGINT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  Name VARCHAR(150) NOT NULL,
  Caption VARCHAR(150) NOT NULL,
  ImageUrl VARCHAR(1000) NULL,
  ProductID BIGINT NOT NULL FOREIGN KEY(ProductID) REFERENCES ProductMaster(ProductID),
  CategoryID INT NULL,
  IsPrimeImage BIT NOT NULL,
  CreatedDate DATETIME NOT NULL,
  CreatedBy INT NOT NULL,
  ModifiedDate DATETIME NULL,
  ModifiedBy INT,
  IsDeleted BIT NOT NULL
);

CREATE TABLE dbo.ProductSpecification(
  SpecificID BIGINT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  Header VARCHAR(150) NOT NULL,
  HeaderContent VARCHAR(250) NULL,
  ProductID BIGINT NOT NULL FOREIGN KEY(ProductID) REFERENCES ProductMaster(ProductID),
  CategoryID INT NULL,
  CreatedDate DATETIME NOT NULL,
  CreatedBy INT NOT NULL,
  ModifiedDate DATETIME NULL,
  ModifiedBy INT,
  IsDeleted BIT NOT NULL
);


CREATE TABLE dbo.EmpRoles(
  EmpRoleID INT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  RoleID INT NOT NULL FOREIGN KEY(RoleID) REFERENCES RoleMaster(RoleID),
  EmpID INT NULL FOREIGN KEY(EmpID) REFERENCES EmployeeMaster(EmpID),
  CategoryID INT NULL FOREIGN KEY(CategoryID) REFERENCES CategoryMaster(CategoryID),
    IsActive INT  NULL,
  CreatedBy INT NOT NULL FOREIGN KEY(CreatedBy) REFERENCES EmployeeMaster(EmpID),
  ModifiedBy INT NULL FOREIGN KEY(ModifiedBy) REFERENCES EmployeeMaster(EmpID),
  CreatedDate DATETIME  NOT NULL,
  ModifiedDate DATETIME NULL
   );

CREATE TABLE dbo.ErrorLog(
  LogID INT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  EventID INT  NULL,
  Priority INT NOT NULL,
  Severity INT NOT NULL,
  Title VARCHAR(150)  NULL,
  MachineName VARCHAR(150)  NULL,
  AppDomainName VARCHAR(150)  NULL,
  ProcessID VARCHAR(150)  NULL,
  ProcessName VARCHAR(150)  NULL,
  ThreadName VARCHAR(150)  NULL,
  Win32ThreadId VARCHAR(150)  NULL,
  Message VARCHAR(MAX)  NULL,
  Timestamp DATETIME  NOT NULL,
  FormattedMessage VARCHAR(1000) NULL
   )
   
  CREATE TABLE dbo.DailyLoginHistory(
  DailyLoginID BIGINT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  EmpID INT  NULL FOREIGN KEY(EmpID) REFERENCES EmployeeMaster(EmpID),
  CustomerID INT  NULL FOREIGN KEY(CustomerID) REFERENCES CustomerMaster(CustID),
  SessionID VARCHAR(200) NULL,
  IpAddress VARCHAR(50) NULL,
  BrowserName VARCHAR(30) NULL,
  LoginType INT NULL,
  LogOutTime DATETIME  NULL,
  LoginTime DATETIME NULL,
   IsLogin BIT NOT NULL
   );

CREATE TABLE dbo.LoginAttemptHistory(
  LoginAttemptID BIGINT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  FailedAttempt INT  NULL,
  EmpID INT NULL FOREIGN KEY(EmpID) REFERENCES EmployeeMaster(EmpID),
  CustomerID INT  NULL FOREIGN KEY(CustomerID) REFERENCES CustomerMaster(CustID),
  LoginDate DATETIME NULL,
  LastLoginDate DATETIME NULL,
  Lattitude VARCHAR(30)  NULL,
  Longitude VARCHAR(30)  NULL,
  IpAddress VARCHAR(30) NULL,
  Browser VARCHAR(30) NULL,
   );

CREATE TABLE dbo.RoleMaster(
  RoleID INT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  Name VARCHAR(50) NOT NULL,
  Code VARCHAR(50) NOT NULL,
  Type INT NULL,
  CreatedBy INT NOT NULL FOREIGN KEY(CreatedBy) REFERENCES EmployeeMaster(EmpID),
  ModifiedBy INT NOT NULL FOREIGN KEY(ModifiedBy) REFERENCES EmployeeMaster(EmpID),
  CreatedDate DATETIME  NULL,
  ModifiedDate DATETIME NULL,
  Status INT NOT NULL,
  IsAdmin INT  NULL
   )

CREATE TABLE dbo.EmpRoles(
  EmpRoleID INT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  RoleID INT NOT NULL,
  EmpID INT NULL FOREIGN KEY(EmpID) REFERENCES EmployeeMaster(EmpID),
  CategoryID INT NULL FOREIGN KEY(CategoryID) REFERENCES CategoryMaster(CategoryID),
    IsActive INT  NULL,
  CreatedBy INT NOT NULL FOREIGN KEY(CreatedBy) REFERENCES EmployeeMaster(EmpID),
  ModifiedBy INT NULL FOREIGN KEY(ModifiedBy) REFERENCES EmployeeMaster(EmpID),
  CreatedDate DATETIME  NOT NULL,
  ModifiedDate DATETIME NULL
   )

CREATE TABLE dbo.EmailService(
  EmailServiceID BIGINT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  TemplateID INT NOT NULL FOREIGN KEY(TemplateID) REFERENCES TemplateMaster(TemplateID),
  FromEmail VARCHAR(150) NOT NULL, 
  FromName VARCHAR(150) NOT NULL,
  ToName VARCHAR(150) NOT NULL,
  ToEmail VARCHAR(150) NOT NULL,
  CcEmail VARCHAR(150)  NULL,
  BccEmail VARCHAR(150)  NULL,
  Subject VARCHAR(250) NOT NULL,
  Body VARCHAR(MAX) NOT NULL,
  IsHtml BIT NOT NULL,
  Priority INT NOT NULL,
  Status INT NOT NULL,
  IsAttachment BIT NOT NULL,
  CreatedBy INT NOT NULL FOREIGN KEY(CreatedBy) REFERENCES EmployeeMaster(EmpID),
  ModifiedBy INT NULL,
  CreatedDate DATETIME NOT NULL,
  ModifiedDate DATETIME NULL,
  AttachmentFileName VARCHAR(50) NULL,
  Remarks VARCHAR(250) NULL
   )

  CREATE TABLE dbo.CommonSetup(
  CommonSetupID INT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  MainType VARCHAR(50) NOT NULL, 
  SubType VARCHAR(50) NOT NULL,
  DisplayText VARCHAR(150) NOT NULL,
  DisplayValue INT NOT NULL,
  ParentID INT NOT NULL,
  CreatedDate DATETIME  NOT NULL,
  ModifiedDate DATETIME NULL
   )

CREATE TABLE dbo.ModuleMaster(
  ModuleID INT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  Name VARCHAR(150) NOT NULL, 
  ParentModuleID INT  NULL,
  ModuleCode INT NULL,
  IsMobile BIT NOT NULL,
  Sequence INT NOT NULL,
  Status INT NOT NULL,
  IsSystemModule BIT NOT NULL,
  Icon VARCHAR(150) NOT NULL, 
  IsStoreWise BIT NULL,
  ModuleType INT NOT NULL,
  ModuleDescription VARCHAR(250) NOT NULL,
  PageURL VARCHAR(350) NOT NULL,
  IsMandatory BIT NULL,
  CreatedBy INT NOT NULL FOREIGN KEY(CreatedBy) REFERENCES EmployeeMaster(EmpID),
  ModifiedBy INT NULL,
  CreatedDate DATETIME NOT NULL,
  ModifiedDate DATETIME NULL,
   )

CREATE TABLE dbo.EmpRoleModulePermission(
  EmpRolePermissionID BIGINT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  RoleModuleID INT  NULL FOREIGN KEY(RoleModuleID) REFERENCES RoleModule(RoleModuleID),
  EmpID INT  NULL FOREIGN KEY(EmpID) REFERENCES EmployeeMaster(EmpID),
  ModuleID INT  NULL FOREIGN KEY(ModuleID) REFERENCES ModuleMaster(ModuleID),
  PermissionID INT NOT NULL,
  PermissionValue VARCHAR(150) NOT NULL,
  CreatedBy INT NOT NULL,
  ModifiedBy INT NULL,
  CreatedDate DATETIME NOT NULL,
  ModifiedDate DATETIME NULL,
  
  )

CREATE TABLE dbo.RoleModule(
  RoleModuleID INT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  RoleID INT NOT NULL FOREIGN KEY(RoleID) REFERENCES RoleMaster(RoleID),
  ModuleID INT NOT NULL FOREIGN KEY(ModuleId) REFERENCES ModuleMaster(ModuleID),
  Sequence INT NOT NULL,
  IsMandatory BIT NOT NULL,
  IsDeleted BIT NOT NULL,
  CreatedBy INT NOT NULL FOREIGN KEY(CreatedBy) REFERENCES EmployeeMaster(EmpID),
  ModifiedBy INT NULL,
  CreatedDate DATETIME NOT NULL,
  ModifiedDate DATETIME NULL,  
  )

CREATE VIEW dbo.vwGetUserRoleModule
AS SELECT m.ModuleID, m.Name, m.ParentModuleID, er.EmpID, Max(m.ModifiedDate) As MaxModifiedDate, m.IsMandatory, m.ModuleCode, m.Icon, m.IsStoreWise, m.Sequence, m.PageURL, m.ModuleType, m.IsMobile, rm.IsDeleted
FROM ModuleMaster m 
INNER JOIN RoleModule rm ON (m.ModuleID = rm.ModuleID)
INNER JOIN EmpRoles er ON (er.RoleID = rm.RoleID)
GROUP BY m.ModuleID, m.Name, m.ParentModuleID, er.EmpID, m.IsMandatory, m.ModuleCode, m.Icon, m.IsStoreWise, m.Sequence, m.PageURL, m.ModuleType, m.IsMobile, rm.IsDeleted



CREATE TABLE dbo.OTPMaster(
  OTPMasterID BIGINT NOT NULL IDENTITY (1,1) PRIMARY KEY,
  EmpID INT NOT NULL FOREIGN KEY(EmpID) REFERENCES EmployeeMaster(EmpID),
  OTP VARCHAR(10) NOT NULL,
  GUID VARCHAR(150)  NULL,
  CreatedDate DATETIME  NOT NULL,
  Attempts INT NULL
   )

ALTER TABLE CategoryMaster
ADD CONSTRAINT PK_CategoryMasterID PRIMARY KEY (CategoryID);

ALTER TABLE CategoryMaster MODIFY COLUMN CategoryID INT NOT NULL AUTO_INCREMENT;







